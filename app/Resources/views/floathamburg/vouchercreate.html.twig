{% extends 'base.html.twig' %}

{% block body %}
    {% if submitted %}
        <h2>{% trans %}voucher.preview{% endtrans %}</h2>

        <div class="create-voucher">
            <div class="row">
                <div class="col-md-8">
                    {{ 'voucher.code'|trans }} {{ voucher.voucherCode }} <br />
                    {% if voucher.onlineVoucher %}
                        {{ 'is.online.voucher' }} <br />
                        {{ 'voucher.order.number'|trans }} {{ voucher.orderNumber }} <br />
                        {{ 'voucher.invoice.number'|trans }} {{ voucher.invoiceNumber }} <br />
                        {{ 'is.included.postal.charges'|trans }}
                        {% if voucher.includedPostalCharges %}
                            {{ 'yes'|trans }} <br />
                        {% else %}
                            {{ 'no'|trans }} <br />
                        {% endif %}
                    {% endif %}
                    {{ 'creation.date'|trans }} {{ voucher.creationDate|date("m/d/Y") }} <br/>
                    {{ 'expiration.date'|trans }} {{ voucher.expirationDate|date("m/d/Y") }} <br/>
                    {{ 'created.by'|trans }} {{ voucher.author }} <br />
                    {{ 'created.at'|trans }} {{ voucher.shopWhereCreated.name }} <br />
                    {{ 'number.of.users' }}
                    {% for user in voucher.numberOfUsers %}
                        {{ user }}
                    {% endfor %} <br />
                </div>
                <div class="col-md-4">
                    <svg id="barcode" data-code="{{ voucher.voucherCode }}"></svg>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    {{ 'voucher.value'|trans }} {{ voucher.remainingValue }} <br />
                    {{ 'voucher.method.of.payment'|trans }} {{ voucher.methodOfPayment }} <br />
                    {{ 'can.be.used.for'|trans }}
                    {% for usage in voucher.usages %}
                        {{ usage }}
                    {% else %}
                        {{ 'no.usages.set'|trans }}
                    {% endfor %}
                    <br /><br />
                    {{ 'you.can.use.this.voucher.in.shop'|trans }} <br />
                    {{ voucher.shopWhereCreated.name }}
                    {{ voucher.shopWhereCreated.address }} <br />
                </div>
            </div>
        </div>
        <br>
        <div class="row">
            <div class="col-md-12 text-center">
                <a href="{{ path('voucher_save') }}" class="btn btn-success">
                    {% trans %}button.voucher.create{% endtrans %}
                </a>
                <a href="{{ path('voucher_edit') }}" class="btn btn-warning">{% trans %}edit{% endtrans %}</a>
                <a href="" class="btn btn-default">{{ 'print'|trans }}</a>
            </div>
        </div>
    {% else %}
        <h2>{{ 'create.voucher'|trans }}</h2>

        <div class="create-voucher">
            {{ form_start(form) }}
            {{ form_errors(form) }}

            {{ form_row(form.onlineVoucher, { attr: { class: "manager" } }) }}
            <div class="interactive hidden" data-managed-by="voucher_onlineVoucher">
                {{ form_row(form.orderNumber) }}
                {{ form_row(form.invoiceNumber) }}
                {{ form_row(form.includedPostalCharges) }}
            </div>
            {{ form_row(form.remainingValue) }}
            {{ form_row(form.numberOfUsers) }}
            <div class="row">
                <div class="col-md-3">
                    {{ form_row(form.usages) }}
                </div>
                <div class="col-md-9">
                    <div class="interactive hidden" data-managed-by="voucher_usages_0">
                        {{ form_row(form.massage_type) }}
                    </div>
                    <div class="row">
                        <div class="interactive hidden col-md-offset-1 col-md-11" data-managed-by="voucher_massage_type" data-manager-val="0">
                            {{ form_row(form.time_for_massage) }}
                        </div>
                    </div>
                    <div class="interactive hidden" data-managed-by="voucher_usages_1">
                        {{ form_row(form.time_for_floating, {'form_group_class': {'class': 'hidden'}}) }}
                    </div>
                </div>
            </div>
            {{ form_row(form.methodOfPayment) }}
            {{ form_row(form.expirationDate) }}
        </div>
        <br />
        <button type="submit" class="btn btn-success center-block">{% trans %}button.voucher.create{% endtrans %}</button>
        {{ form_end(form) }}
    {% endif %}
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('assets/js/createVoucherFormHandling.js') }}" charset="utf-8"></script>
    <script src="{{ asset('assets/js/barcode.js') }}"></script>
{% endblock %}
